<div class="summary">
  <span class="availability" ng-class="highlight" ng-bind="availability"></span>
  <span class="status" ng-bind="status"></span>
  <a class="detail-toggle" ng-click="showdetails=!showdetails">{{showdetails ? 'Hide' : 'Show'}} numbers</a>
</div>
<div class="details" ng-if="showdetails">
  <table>
    <thead>
    <tr>
      <th>Category</th>
      <th>Last Updated</th>
      <th>Total</th>
    </tr>
    </thead>
    <tbody>
    <tr>
      <td>Contractual Capacity</td>
      <td>N/A</td>
      <td ng-bind="capacity"></td>
    </tr>
    <tr>
      <td>Occupied</td>
      <td ng-bind="heartbeatreceived"></td>
      <td ng-bind="inuse">}</td>
    </tr>
    <tr>
      <td>Beds out of commission</td>
      <td ng-bind="heartbeatreceived"></td>
      <td ng-bind="ooc"></td>
    </tr>

    <tr ng-if="prebooking !== undefined" ng-click="showPrebooking = prebooking.length>0 && !showPrebooking"
        class="{{prebooking.length>0 ? showPrebooking ? 'close' : 'open' : ''}}">
      <td>
        Prebookings
        <table ng-if="showPrebooking">
          <thead>
            <tr>
              <th>Requester</th>
              <th>CID id</th>
            </tr>
          </thead>
          <tbody>
            <tr ng-repeat="thePrebooking in prebooking">
              <td>{{thePrebooking.requester}}</td>
              <td>{{thePrebooking.cid_id}}</td>
            </tr>
          </tbody>
        </table>
      </td>
      <td ng-bind="prebookingreceived"></td>
      <td ng-bind="prebooking.length"></td>
    </tr>
    <tr ng-if="contingency !== undefined" ng-click="showContingency = contingency.length>0 && !showContingency"
        class="{{contingency.length>0 ? showContingency ? 'close' : 'open' : ''}}">
      <td>
        Contingency
        <table ng-if="showContingency">
          <thead>
          <tr>
            <th>Requester</th>
            <th>CID id</th>
          </tr>
          </thead>
          <tbody>
          <tr ng-repeat="theContingency in contingency">
            <td>{{theContingency.requester}}</td>
            <td>{{theContingency.cid_id}}</td>
          </tr>
          </tbody>
        </table>
      </td>
      <td ng-bind="prebookingreceived"></td>
      <td ng-bind="contingency.length"></td>
    </tr>

    <tr ng-if="expectedin !== undefined" ng-click="showIncoming = expectedin.length>0 && !showIncoming"
        class="{{expectedin.length>0 ? showUnIncoming ? 'close' : 'open' : ''}}">
      <td>
        Expected incoming
        <ul ng-if="showIncoming">
          <li ng-repeat="theExpectedout in expectedout">{{theExpectedout.cid_id}}</li>
        </ul>
      </td>
      <td ng-bind="cidreceiveddate"></td>
      <td ng-bind="expectedin.length"></td>
    </tr>
    <tr ng-if="unexpectedin !== undefined" ng-click="showUnIncoming = unexpectedin.length>0 && !showUnIncoming"
        class="{{unexpectedin.length>0 ? showUnIncoming ? 'close' : 'open' : ''}}">
      <td>
        Unexpected incoming
        <ul ng-if="showUnIncoming">
          <li ng-repeat="theUnexpectedin in unexpectedin">{{theUnexpectedin.cid_id}}</li>
        </ul>
      </td>
      <td ng-bind="cidreceiveddate"></td>
      <td ng-bind="unexpectedin.length"></td>
    </tr>

    <tr class="availability">
      <td>Availability</td>
      <td></td>
      <td ng-class="highlight" ng-bind="availability"></td>
    </tr>

    <tr ng-if="expectedout !== undefined" ng-click="showOutgoing = expectedout.length>0 && !showOutgoing"
        class="{{expectedout.length>0 ? showOutgoing ? 'close' : 'open' : ''}}">
      <td>
        Expected outgoing
        <ul ng-if="showOutgoing">
          <li ng-repeat="theExpectedout in expectedout">{{theExpectedout.cid_id}}</li>
        </ul>
      </td>
      <td ng-bind="cidreceiveddate"></td>
      <td ng-bind="expectedout.length"></td>
    </tr>
    </tbody>
  </table>
</div>
